%%%%
\section{Modelos Receptores}

Modelo receptor é uma abordagem matemática para determinar e 
quantificar o efeito das fontes poluidoras do ar em amostras.

\textbf{Análise de Fatores (AF)} e 
\textbf{Positive Matrix Fatorization (PMF)} são técnicas matemáticas
de análise multivariada usadas em modelos receptores e 
permitem a identificação de fontes quando os seus perfis são desconhecidos.

Outra técnica que resolve os modelos receptores é 
o Balanço Químico de Massa (CMB), usando quando se conhece 
o perfil das fontes locais e permite verificar o impacto das fontes 
nas concetrações medidas no amostrador. 
O CMB não foi usado nesta pesquisa, já que não medimos os perfis 
das fontes. 

A análise multivariada é uma técnica estatística utilizada para 
reduzir a dimensão de dados matriciais. 
Permite manter a quantidade de informação contida inicialmente nos dados, 
armazenada na variância e covariância. 
Nomeia-se de fator as novas variáveis reduzidas, que são
ortogonais entre si. 
O fator é uma variável latente, pois não é uma grandeza diretamente
medida, mas sim obtida a partir de outras variáveis observáveis. 

As dimensões (variáveis) reduzidas de um conjunto de dados analíticos 
complexo podem ser interpretados como fonte(s) poluídora(s) 
\citep{wang2012} e \citep{mansha2012}.

O número de fatores extraídos dependerá das possíveis 
fontes poluidoras, número de amostras, resolução da amostragem 
e espécies medidas.

O conhecimento do pesquisador é imprescindível para fazer o relacionamento 
entre fator e fonte(s), avaliando o significado físico das fontes. 
Informações das possíveis fontes poluidoras próximas ao ponto 
receptor, dados meteorológicos do período de coleta, inventário de emissões 
e outras informações ajudam no mapeamento fator-fonte(s).
Assim, o principal desafio em análises multivariada é identificar 
se o fator de fato existe enquanto fonte(s) poluídora(s). 

Número reduzido de amostras, baixa resolução da amostragem, \textbf{outliers} 
(eventos infrequentes de curta duração e com alta concentração) representam 
um desafio para modelos multivariados.

%%%%
\subsection{Conservação da massa}

Os poluentes que são emitidos pelas fontes em uma bacia aérea devem chegar no 
receptor, podendo-se, assim, usar o princípio de conservação da massa 
no modelo receptor. 

Aplicando-se a equação de conservação da massa para uma amostragem que se 
coletou $i$ amostras e mediu-se $j$ poluentes tem-se a 
equação \ref{eq:conservacaomassa}.

\begin{equation}
  \label{eq:conservacaomassa}
  x_{ij} = \sum_{p=1}^{P} g_{ip}f_{pj} %+ \epsilon_{ij}
\end{equation} 

sendo,
\begin{itemize}
  \item $x_{ij}$ = concentração na amostra receptora $i$ da espécie $j$;
  \item $f_{pj}$ = fração da espécie $j$ emitida pela fonte $p$;
  \item $g_{ip}$ = contribuição da fonte $p$ para amostra $i$;
  %\item $\epsilon_{ij}$ = erro do modelo empregado.
\end{itemize}

%%%%
\subsection{Análise de Fatores (AF)}

A técnica Análise de Fatores (AF) consiste na redução da dimensionalidade dos dados, 
para uma nova base contendo a menor dimensão possível, 
relativamente à dimensão dos dados originais.

A redução é feita de tal forma que estas novas variáveis (Fatores) 
sejam combinação linear das anteriores e que representem a máxima fração possível da 
variabilidade contida naquelas variáveis. 

Popularizada após a publicação do trabalho de Lourenz em 1956, que chamou 
a técnica de Análise de Funções Ortogonais Empíricas, 55 anos após a 
descoberta da mesma por Karl Pearson \citep{bartholomew2011}.

Dado as variáveis observáveis ($x_1,\dots,x_j$) com 
respectivas médias $\mu_1,\dots,\mu_j$ a equação da análise de fatores 
pode ser escrita como em \ref{eq:af}. 
 
\begin{equation}
  \label{eq:af}
  x_i-\mu_i = l_{i1} F_1 + \cdots + l_{ip} F_p + \varepsilon_i 
\end{equation}

Sendo $F$ os fatores extraídos e $l_{ip}$ o peso ou $loading$ 
da variável $i$ no fator $p$.

Um problema comum em AF é a de multicolinearidade, assim, 
deve-se evitar amostras medidas em paralelo. 

A comunalidade é igual a soma dos $loading$ ao quadradro 
para cada variável e indica como cada variável foi explicada pelo ajuste. 
$0$ indica que a variável não foi nada explicada pelos fatores extraídos 
no ajuste e $1$ indica que foi completamente explicada.

Deve-se checar sempre a variância total da explicada que indica 
o quanto da variabilidade dos dados inicais foi explica pelo ajuste. 
Ajuste com 80\% de variância total da explicada são considerados bons. 

A rotação tipo Varimax dos resultados da AF 
para um novo sistema de eixos foi feita para maximizar as variâncias 
e melhorar entendimento dos resultados \citep{kaiser1958}.

Por fim, os critérios usados para retenção dos fatores foram:
1. reter um número de componentes suficientes para explicar 85\% da 
   variância total da explicada;
2. reter os componentes cujos autovalores são maiores que 1;
3. usar um gráfico scree exibindo os autovalores associados aos fator e
   verificar se o fator não está degenerado. 

%TODO: não sei ainda se voo colocar a discussão de fatores absolutos 

%equação para fatores absulutos, ou seja, é a recomposição dos fatores que 
%são resultados da análise dos dados a partir da normalização dos dados 
%originais pela média e pelo desvio padrão.
%\citep{keiding1986}

%Onde, sj é o desvio padrão da variável j para todas as N amostras; 
%Bjp é o valor dos 'factor loadings' rotacionados para a variável j num fator p; 
%sMP é o desvio padrão do material particulado para todas as N amostras; 
%Cp é o valor do 'factor loading' referente ao material particulado num fator p.

%\begin{eqnarray}
%FA = \frac{L_{ij}\sigma_i}{\sigma_{PM}L_{PM_j}}
%\end{eqnarray}

%\begin{itemize}
%  \item L = loadings
%  \item i = espécies
%  \item j = fatores extraídos
%\end{itemize}

%Factor Scores: 
%\begin{equation}
%FatorScore1 = coeficiente_{elemento1 fator1}*valor_elemento1 + coeficiente_{elemento2 fator1}*valor_elemento2 ...
%\end{equation} 

%%%%
\subsection{Positive Matrix Factorizarion}

Positive Matrix Factorizarion (PMF) é outro método multivariado usado
em modelos receptores e permite determinar um conjunto de fatores $p$, 
o perfil $f$ das espécies de cada fonte e a contribuição da massa $g$ de cada fator 
para cada amostra individual \citep{norris2014}. 

O PMF resolve a equação de conservação de massa usando a resolução por 
mínimos quadrados, diferente da AF, que reduz a dimensão dos 
dados decompondo a matriz de correlação em autovalores e autovetores. 

O usuário informa a quantidade de fatores desejados $p$ e o PMF 
tentará encontrar uma solução para quantidade de fatores inseridos e 
mesmo que o PMF retorne um ajuste matematicamente consistente 
é necessário verificar o significado físico da solução.

Dada uma campanha da amostragem com $i$ amostras válidas e 
$j$ espécies medidas, a matriz das concentrações $c_{ij}$ 
pode ser decomposta em $g_{ik}$ e $f_{kj}$ conforme \ref{eq:pmf}. 
O PMF procura um par das matrizes $g_{ik}$ e $f_{kj}$ que
minimizam a função objeto $Q$ da equação \ref{eq:pmfobject}. 

\begin{equation}
  c_{ij} = \sum_{k=i}^p g_{ik}f_{kj} + e_{ij}
  \label{eq:pmf}
\end{equation}

Onde,
\begin{itemize}
  \item $c_{ij}$ matriz de concentração
  \item $u_{ij}$ matriz de incertezas (experimentais e analíticas)
  \item $p$: O número de fatores informado pelo usuário.
  \item $g_{ik}$: Contribuição dos fatores nas amostras (\textit{Factor Score}).
  \item $f_{kj}$: Perfil da fonte ou assinatura da fonte, ou seja, 
        a distribuição das espécies nos fatores. (\textit{Factor Loadings}).
  \item $e_{ij}$: Matriz dos resíduos escalados pelas incertezas.
\end{itemize}

\begin{equation}
  Q = \sum_{i=1}^n \sum_{j=1}^m  \left[ \frac{e_{ij}} {u_{ij}} \right] ^2
  \label{eq:pmfobject}
\end{equation}

O método PMF tem sido muito utilizado em pesquisas de poluição 
atmosférica, pois inclue um algoritmo robusto desenvolvido por \citep{paatero1994}
que impede o aparecimento de valores negativos no perfil e na contribuição de fontes.

Diferente da AF, pondera o ajuste pelas incertezas das concentrações, 
diminuíndo assim o peso de espécies com incertezas altas \ref{eq:pmfobject}.
Por isso é necessário que os resultados e de XRF e \textit{Black Carbon}
tenham incerteza que englobem .

%%%%
\subsubsection{Função Objeto}

Na matemática, função objeto é uma função que precisa ser minimizada 
ou maximizada usando métodos numéricos para equações não lineares, pois não 
tem solução analítica. A matriz de resíduo ${e_{ij}}$ da equação \ref{eq:pmf}
pode ser substítuida em \ref{eq:pmfobject} obtendo-se \ref{eq:pmfobjectfull}.

\begin{equation}
  Q = \sum_{i=1}^n \sum_{j=1}^m  \left[ \frac{c_{ij} - \sum_{k=i}^p g_{ik}f_{kj}} {u_{ij}} \right] ^2
  \label{eq:pmfobjectfull}
\end{equation}

A solução para \ref{eq:pmfobjectfull} foi inicialmente implementada usando 
o método de Gauss-Newton \citep{paatero1994}, mas na 
versão atual do software \textbf{PMF EPA 5.0} \citep{norris2014} é usado o Método do Gradiente Conjugado.

Os valores de $g_{ik}$ e $f_{kj}$ são iniciados randomicamente e
são ajustados até se chegar no menor $Q$.
 
O \textbf{PMF EPA 5.0} nos oferece dois valores para $Q$: $Q_{verdadeiro}$ e 
$Q_{robusto}$, onde o primeiro é calculado considerando todos os valores 
de concentração e no segundo remove-se os \textbf{outliers}.
Assim quando há poucos \textit{outliers}, $Q_{verdadeiro}$ e $Q_{robusto}$ 
são próximos. Incertezas muitos altas resultam em $Q_{verdadeiro}$ e 
$Q_{robusto}$ similares.


